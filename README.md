# Intelligent Pay

유지보수가 쉬운 설계에 최대한 초점 맞추기
=> 모듈화, 결합도 낮추기, 응집도 높이기.
api + DB + 함수 의존성 제거하기

확장가능한 설계에도 초점 맞추기
타 서비스와 연동 + 연계가 쉬워야함.
=> 향후 제작할 intelligent_store 서비스와 연동 가능하게 설계함.

화면 정의서와 기본적인 설계 상세하게 고민하여 설계하기

인텔리전트 뱅크 리빌드. (기능 추가 + 리팩토링) => XxPay 라는 이름으로
송금은 구현가능하나, 결제의 경우에는 api를 통해 atm입출금 같은 느낌으로 처리하면된다.
조건은 카드를 긁거나, qr을 찍었을때, 또는 온라인으로 결제하여 위의 api로 들어왔다고 가정하면된다.
송금, 결제, 포인트가 존재한다.
pg처럼 외부에 제공하는 api도 있어야함.

## api, db, 함수 의존성 최소화
api를 종속적으로 만들지 말아라. db도 나누고, 도메인도 나누고(마이크로서비스), api도 마치 함수처럼 나눈다. 
마이페이지를 위한 함수를 만들지말고 여러군데에서 사용할 수있도록 하기위해 함수를 만드는 것 처럼 api도 그러하다. 
db를 설계하고, 전체 아키텍처를 설계할때도 마찬가지이지만 성능은 맨 마지막에 고려해야한다. 
왜냐하면 성능을 튜닝하는 법은 너무 많기 때문이다. 성능에 목매면 설계가 박살날수있다.
설계할때 프론트 단까지 모든 api를 설계하고, 백엔드는 프론트에 전달해줄 api만 만들면된다. 
백엔드에서 모든 api를 다 처리하려고하니깐 문제가 생겼던 것이다. 
프론트와 백은 분리가되어있으니 백은 오로지 데이터 전달을 위한 통신용 api설계에만 집중하면 된다.

## DB 설계
-> 한 테이블에 다 때려박으면 쓸데없는 리소스를 소모하기 때문에, 분류하자.
-> 다른 프로젝트들도 리팩토링 하고 싶은 부분은 DB를 쪼개서 소모를 줄이고
-> DB에 최소한의 데이터만 둔다. 그리고 하나의 화면에 여러 api로 데이터를 전달한다.
-> 이를 통해서 진짜 필요한 데이터만 가지고 있고, 마이크로서비스 아키텍처의 장점을 극대화 한다.
-> 필요한 api로 땡겨오고, 데이터베이스에는 꼭 필요한것만 저장하라.
-> 마치 아래에서 소개된 상품을 조회할때 여러 서비스에서 필요한 데이터들을 가져와 최종적으로 조합하듯 말이다.
-> 데이터를 아주 섬세하게 저장하고 섬세하게 가져오자!!
-> 외부 api로 데이터를 가져오는것을 너무 두려워 해선 안될것 같음.
DB를 쪼개고 나누게되면 시스템이 유연하게 동작하기때문에 두려워하지 말기.
상품이 있다면 상품의 가격을 담당하는 부분과 별점과 리뷰를 담당하는 부분 등 여려가지 부분이 있다.
이것을 상품데이터에 모두 저장하고, 읽기 쓰기 작업을하게되면 부하가 한곳에 집중된다.
읽기를 할때 모든 데이터가 필요한것도 아니고, 쓰기를 할때도 마찬가지이다.
따라서 이를 나누어서 분산시켜, 필요할때 필요한 데이터만, 혹은 다 필요하면 조인 등으로 모두 가져오면 되는것이다.
이렇게 사용하다가 서비스가 더욱커져서 db의 분산만으로안되고 db를 아예 물리적으로 분산해야한다면
마이크로서비스를 이용해 쿠팡처럼 하는것도 가능해진다.
쿠팡의 경우 제품의 이미자와 이름은 catalog팀에서, 가격은 pricing 팀에서
재고 정보는 fulfillment 팀에서 제공하는 방식으로 하여 유연성을 높였다.
DB를 설계할때 이러한 것을 염두해두고 시나리오를 그려보고, 
분산하여 설계를 한다면 향후 거대한 시스템과 대규모 트래픽 대응, 대용량 데이터처리에 훨씬 용이해질 것이다.